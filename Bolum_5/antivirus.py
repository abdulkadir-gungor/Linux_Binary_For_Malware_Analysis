#!/bin/python3 
#############################################
# +---------------------------------------+ #
# |    Verilen Heximal Değeri Programda   | #
# |     Ikili (Bayt) Degerlerinde Arar    | #
# |                                       | #
# |      Abdulkadir GÜNGÖR (2021)         | #
# +---------------------------------------+ #
#############################################
import sys

def uploadFile(path:str=''):
    try:
        with open(file=path, mode='rb') as file:
            upload_file = file.read()
        return True, upload_file
    except:
        return False, b''

argLen = len(sys.argv)
if argLen == 3:
    try:
        program_path   = sys.argv[1]
        find_bytes = bytes.fromhex(sys.argv[2])
        upload_result , program_bytes  = uploadFile(program_path) 
        if upload_result:
            if program_bytes != b'':
                find_count = program_bytes.count(find_bytes)
                if find_count == 0:
                    print("\n")
                    print(" Program tarandı. Ilgili kod dizilimi bulunamadı.")  
                    print("\n")
                else:
                    print("\n")
                    print(" Zararlı yazılım tespit edildi.")
                    print(" Ilgili kod dizilimi, yazılımda {} kez tespit edildi.".format(str(find_count)) )  
                    print("\n")
        else:
            print("\n")
            print("\t/* Taranacak program yuklenemedi! */")
            print("\n")
    except:
        print ("\n\tHata Oluştu!\n")
else:
    print("\n")
    print("\t/* Programda verilen heximal değerleri arar. */")
    print("\t/* Çalışma yöntemi ile ilkel bir antivirüs programıdır.*/")
    print("")
    print( '\tKullanımı :  <Komut> "Taranacak Program" "Aranan Imza Hex Degeri"  ' )
    print( '\tÖrnek     :   {} "system" "e507e5"   '.format( sys.argv[0] ) )
    print("\n")
    print("\tAbdulkadir Güngör (2021) tarafından eğitim icin hazırlanmıştır.")
    print("")



